# iot-django


Запуск

1. Установка зависимостей
```shell
pip3 install -r requirements.txt
```

2. Запуск docker с Postgres
```shell
mkdir postgresql_data
sudo chmod 777 postgresql_data
sudo chown -R "ИМЯ_ПОЛЬЗОВАТЕЛЯ_UBUNTU" postgresql_data
```

3. Задать настройки .env.example
4. Запустить docker с БД
```shell
docker-compose --env-file ./.env.example up
```

5. Применить миграции django
```shell
python3 ./manage.py migrate
```

6. Создать пользователя по умолчанию на основе данных из .env
```shell
python ./manage.py create_superuser
```

7. Запустить сервер
```shell
python ./manage.py runserver
```

8. Перейти по ссылке на 127.0.0.1:8000

API:
- `127.0.0.1:8000/api/6HGePXCH9bFMuJyu` - страница администратора django. Данные для входа в .env файле

----

- GET `http://127.0.0.1:8000/api/auth/current-user/`: 

Получение текущего пользователя в формате JSON.

Получаемые данные:
  - `user`: значение null - не выполнена авторизация, иначе словарь из полей email, last_name текущего пользователя

----
- POST `http://127.0.0.1:8000/api/auth/login/`:

Выполнение авторизации в системе. Отправка почты/пароля родителя из БД для входа.

Отправляемые данные:
  - `email`: почта пользователя из таблицы `parent` - строка
  - `password`: пароль пользователя из таблицы `parent` - строка

Получаемые данные:
  - `email`: почта пользователя из таблицы `parent` за которого выполнена авторизация в системе - строка
  - `id`: `id` пользователя из БД за которого выполнена авторизация в системе - число

В случае, если пользователь не найден, не указаны нужные поля для входа, то возвращается ответ вида:
```
{
    "error": "Пользователь с данной почтой или паролем не найден"
}
```

----
- POST `http://127.0.0.1:8000/api/auth/logout/`:

Выход из системы. 
 